<!DOCTYPE html>

<html lang="en">
  <head>
  <title>Setting up and adding Azure accounts to Cloud Manager | NetApp Cloud Docs</title>
  <meta charset="utf-8">
  <meta property="og:title" content="Setting up and adding Azure accounts to Cloud Manager | NetApp Cloud Docs" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://docs.netapp.com/occm/en/task_adding_azure_accounts.html" />
	<meta property="og:description" content="If you want to deploy Cloud Volumes ONTAP in different Azure accounts, then you need to provide the required permissions to those accounts and then add detai..." />
  <meta property="og:image" content="https://docs.netapp.com/occm/en/images/logo-tophat-social.png" />
  <meta property="og:image:alt" content="NetApp Logo" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="format-detection" content="telephone=no">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge,chrome=1">
  <meta http-equiv="encoding" content="utf-8">
  <meta http-equiv="nss-type" content="Product Documentation"/>
  <meta http-equiv="nss-subtype" content="User Guide"/>
  
  <meta http-equiv="nss-product" content="OnCommand"/>
  
  <meta name="description" content="If you want to deploy Cloud Volumes ONTAP in different Azure accounts, then you need to provide the required permissions to those accounts and then add detai...">
  <meta name="keywords" content=" permissions, microsoft, azure, permissions, custom role, role, json, active directory, ad, service principal, key, tenant id, application key, application id, operator role, managed identity, iam, operator, role, virtual machine">
  
  

  <!-- Icons -->
  <link rel="icon" href="/occm/en/images/favicon.ico" type="image/x-icon">

  <!-- RSS Feed -->
  
  <link rel="alternate" type="application/rss+xml" title="NetApp Cloud Docs" href="/occm/en/feed.xml">
  

  <!-- CSS Definitions: NetApp CSS should be defined after generic css -->

  <!-- Elastic Search -->
  <link rel="stylesheet" href="//cdn.jsdelivr.net/searchkit/0.10.0/theme.css">

  <!-- LUCI CSS Content -->
  <link rel="stylesheet" href="/occm/en/common/css/esb.min.css">
  <link rel="stylesheet" href="/occm/en/common/css/netapp-library.min.css">
  <link rel="stylesheet" href="/occm/en/common/css/doc.css">
  <link rel="stylesheet" href="/occm/en/common/css/doc-components.css">

  <link rel="stylesheet" href='/occm/en/css/na-sidebar.css' type='text/css'>
  <link rel='stylesheet' href='/occm/en/css/na-search.css' type='text/css'>
  <link rel='stylesheet' href='/occm/en/css/clouddocs.css' type='text/css'>

  <!-- Font awesome seems to affect our GitHub Icon and generic "arrow box" for external links. -->
  <link rel="stylesheet" type="text/css" href="/occm/en/css/font-awesome.min.css">
  <!-- <link rel="stylesheet" href="/occm/en/css/customstyles.css"> -->
  <!-- Controls the shadow effect for search dropdown menu -->
  <link rel="stylesheet" href="/occm/en/css/boxshadowproperties.css">

  <!-- NetApp CSS controls the technical content -->
  <link rel='stylesheet' href='/occm/en/css/netapp.css' type='text/css'>

  

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
  <!-- Used to import Promise for IE. Required for SearchKit -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bluebird/3.3.5/bluebird.min.js"></script>
  
    <script src='/occm/en/js/na-search.js'></script>
  

  
  <link rel='stylesheet' href='/occm/en/css/na-pagenav.css' type='text/css' id="pagenav-css">
  <script src='/occm/en/js/na-pagenav.js'></script>
  

  <link rel='stylesheet' href='/occm/en/css/prism.css' type='text/css'>
  <link rel='stylesheet' href='/occm/en/css/prism-netapp.css' type='text/css'>

  <script src='/occm/en/js/clouddocs.js'></script>
  <script src='/occm/en/js/s_code_impl.js'></script>
  <script src='/occm/en/js/jquery.navgoco.min.js'></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
  <script src='/occm/en/js/toc.js'></script>
  <script src='/occm/en/js/customscripts.js'></script>

  <script>
      $(document).ready(function() {
          
          var collapseOnInit = true;
          

          var navSettings = {
              "caretHtml": '',
              "accordion": collapseOnInit,
              "openClass": 'active', // open
              "save": false, // leave false or nav highlighting doesn't work right
              "cookie": {
                  "name": 'navgoco',
                  "expires": false,
                  "path": '/'
              },
              "slide": {
                  "duration": 400,
                  "easing": 'swing'
              }
          };

          // Initialize navgoco with default options
          $("#mysidebar").navgoco(navSettings);
          

          $("#collapseAll").click(function(e) {
              e.preventDefault();
              $("#mysidebar").navgoco('toggle', false);
          });

          $("#expandAll").click(function(e) {
              e.preventDefault();
              $("#mysidebar").navgoco('toggle', true);
          });

      });

  </script>
  <script>
      $(document).ready(function() {
          $("#tg-sb-link").click(function() {
              $("#tg-sb-sidebar").toggle();
              $("#tg-sb-content").toggleClass('col-md-9');
              $("#tg-sb-content").toggleClass('col-md-12');
              $("#tg-sb-icon").toggleClass('fa-toggle-on');
              $("#tg-sb-icon").toggleClass('fa-toggle-off');
          });
      });
  </script>

  <!-- Controls the i18n Browser Redirection -->
  <script>
    var siteLocales = [];
    
      siteLocales.push("us-en");
    
      siteLocales.push("en");
    
      siteLocales.push("ja-jp");
    

    standardizeUrl(siteLocales, "clouddocs.netapp.com", "https://docs.netapp.com");
  </script>

  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-81697994-3"></script>
  <script>
  if (document.location.hostname === "docs.netapp.com") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-81697994-3');
  }
  </script>
</head>


  <body class="n-doc__component-detail">
    <a href="#n-main-content" class="visually-hidden">Skip to main content</a>
<div class="n-off-canvas-menu">
  <div class="n-off-canvas-menu__menu">
    <div class="n-off-canvas-menu__menu-inner">
      <div class="n-off-canvas-menu__property-title">NetApp Cloud Docs</div>
      <ul class="n-off-canvas-menu__property-navigation-list">
        <li class="n-off-canvas-menu__property-navigation-list-item ">
          <a href="https://docs.netapp.com/en/" class="n-off-canvas-menu__property-navigation-link">
            Home
          </a>
          <div class="n-off-canvas-menu__child-menu">
            <ul class="n-menu__list">

            </ul>
          </div>
        </li>
      </ul>

      <ul class="n-off-canvas-menu__global-navigation-list">
         <li class="n-off-canvas-menu__global-navigation-list-header">More From NetApp</li>
         <li class="n-off-canvas-menu__global-navigation-list-item"><a href="#" class="n-off-canvas-menu__global-navigation-link">Netapp.com</a></li>
      </ul>
    </div>
  </div>
</div>

    <div class="n-off-canvas-menu__content-wrap">
      <!-- Header -->
      <header>
  <!-- Top Hat -->
  <div class="n-top-hat">
    <div class="n-container">
      <div class="n-top-hat__cross-property-nav">
        <ul class="n-top-hat__list">
            <li class="n-top-hat__list-item">
              <a href="http://www.netapp.com" class="n-top-hat__link">NetApp.com</a>
            </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Property Bar -->
  <div class="n-property-bar n-property-bar--v3">
    <div class="n-property-bar__inner-wrap">
      <div class="n-property-bar__menu-toggle">
        <a href="#" class="n-property-bar__menu-toggle-link"><span class="n-property-bar__menu-toggle-text">Menu</span><svg class="n-icon-bars n-property-bar__menu-toggle-icon" aria-labelledby="title">
          <title>bars</title>
          <use xlink:href="/occm/en/common/svg/sprite.svg#bars"></use>
        </svg></a>
      </div>
      <div class="n-property-bar__property-mark n-property-bar__property-mark--has-property-name">
        <a class="n-property-bar__property-link" href="https://docs.netapp.com/en/">
          <div class="n-property-bar__logo">
            <svg class="n-icon-netapp-mark n-property-bar__netapp-mark-icon" aria-labelledby="title">
              <title>netapp-mark</title>
              <use xlink:href="/occm/en/common/svg/sprite.svg#netapp-mark"></use>
            </svg>
            <svg class="n-property-bar__logo-svg" aria-labelledby="title">
              <title>NetApp</title>
              <use xlink:href="/occm/en/common/svg/sprite.svg#netapp-logo"></use>
            </svg>
          </div>
          <h2 class="n-property-bar__property-name">Cloud Docs</h2>
        </a>
      </div>

      
      <div id="search-demo-container" class="n-property-bar__search">
        <div id="react-search"></div>
      </div>
      

      <div id="ie-i18n" class="n-property-bar__utils">
        <div id="ie-i18n-menu">
          <ul class="n-property-navigation-bar__utils-list">
            <li class="n-property-navigation-bar__utils-list-item ie-i18n-container">
              <a href="#" class="n-property-navigation-bar__utils-link n-property-navigation-bar__nav-link n-property-navigation-bar__language-selector-toggle ie-i18n-link" data-menu-id="n-property-navigation-bar__menu--language-selector">
                <span class="ie-i18n-lang"></span>
                <svg class="ie-i18n-icon-container" class="n-property-bar__logo-svg" aria-labelledby="title">
                  <title>globe</title>
                  <use xlink:href="/occm/en/common/svg/sprite.svg#globe" class="n-icon-globe n-globe__icon"></use>
                </svg>
              </a>
            </li>
          </ul>
        </div>
        
      </div>
    </div>

    <div class="n-property-bar__menus">
      <div id="n-property-navigation-bar__menu--language-selector" class="n-menu n-menu--v3">
        <div class="n-language-selector-menu">
          <div class="n-language-selector-menu__header">
            <span class="n-language-selector-menu__title">Select Your Language</span>
          </div>
          <ul class="n-menu__list">
            <li class="n-menu__list-column">
              <ul class="n-menu__list">
                
                
                
                <li class="n-menu__list-item n-menu__list-item--level-1">
                  <a href="/occm/us-en/" class="n-menu__header-text"><span translate="no" class="notranslate">English</span></a>
                </li>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                <li class="n-menu__list-item n-menu__list-item--level-1">
                  <a href="/occm/ja-jp/" class="n-menu__header-text"><span translate="no" class="notranslate">日本語</span></a>
                </li>
                
                
                
                
                
                
                
                
                
                
                
              </ul>
            </li>
          </ul>
          <div class="menu__footer">
            <p>Current Language: 
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>


      <!-- Content -->
      <main role="main" id="n-main-content" class="n-main-content">
        
<div class="n-container">
  <div class="n-row">
    <div class="n-doc n-doc__component-list">
      <!-- Sidebar Column -->
      
      <div class="col-md-3" >
          

<ul id="mysidebar" class="nav">
  

  
    <li><a href="index.html">Cloud Manager 3.8 docs</a></li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Release notes</a>
      <ul>
        

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Cloud Manager</a>
      <ul>
        

  
    <li><a href="reference_new_occm.html">What's new</a></li>
  

  
    <li><a href="reference_issues.html">Known issues</a></li>
  

  
    <li><a href="reference_limitations.html">Known limitations</a></li>
  


      </ul>
    </li>
  

  
    <li><a href="https://docs.netapp.com/us-en/cloud-volumes-ontap/" target="_blank">Cloud Volumes ONTAP</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Concepts</a>
      <ul>
        

  
    <li><a href="concept_overview.html">Product overview</a></li>
  

  
    <li><a href="concept_cloud_central.html">NetApp Cloud Central</a></li>
  

  
    <li><a href="concept_cloud_central_accounts.html">Cloud Central accounts</a></li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Cloud provider accounts</a>
      <ul>
        

  
    <li><a href="concept_accounts_aws.html">AWS accounts</a></li>
  

  
    <li><a href="concept_accounts_azure.html">Azure accounts</a></li>
  

  
    <li><a href="concept_accounts_gcp.html">GCP accounts</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Storage</a>
      <ul>
        

  
    <li><a href="concept_storage.html">Disks and aggregates</a></li>
  

  
    <li><a href="concept_data_tiering.html">Data tiering</a></li>
  

  
    <li><a href="concept_storage_management.html">Storage management</a></li>
  

  
    <li><a href="concept_worm.html">WORM storage</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">High-availability pairs</a>
      <ul>
        

  
    <li><a href="concept_ha.html">HA pairs in AWS</a></li>
  

  
    <li><a href="concept_ha_azure.html">HA pairs in Azure</a></li>
  


      </ul>
    </li>
  

  
    <li><a href="concept_evaluating.html">Evaluating</a></li>
  

  
    <li><a href="concept_licensing.html">Licensing</a></li>
  

  
    <li><a href="concept_security.html">Security</a></li>
  

  
    <li><a href="concept_performance.html">Performance</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Get started</a>
      <ul>
        

  
    <li><a href="reference_deployment_overview.html">Deployment overview</a></li>
  

  
    <li><a href="task_getting_started_aws.html">Get started in AWS</a></li>
  

  
    <li><a href="task_getting_started_azure.html">Get started in Azure</a></li>
  

  
    <li><a href="task_getting_started_gcp.html">Get started in GCP</a></li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Set up Cloud Manager</a>
      <ul>
        

  
    <li><a href="task_setting_up_cloud_central_accounts.html">Set up the Cloud Central account</a></li>
  

  
    <li><a href="task_adding_aws_accounts.html">Add AWS accounts</a></li>
  

  
    <li class="active"><a href="task_adding_azure_accounts.html">Add Azure accounts</a></li>
  

  
    <li><a href="task_adding_gcp_accounts.html">Add GCP accounts (9.6 only)</a></li>
  

  
    <li><a href="task_adding_nss_accounts.html">Add NetApp Support Site accounts</a></li>
  

  
    <li><a href="task_installing_https_cert.html">Install an HTTPS certificate</a></li>
  

  
    <li><a href="task_setting_up_kms.html">Set up the AWS KMS</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Network requirements</a>
      <ul>
        

  
    <li><a href="reference_networking_cloud_manager.html">Cloud Manager</a></li>
  

  
    <li><a href="reference_networking_aws.html">Cloud Volumes ONTAP for AWS</a></li>
  

  
    <li><a href="task_setting_up_transit_gateway.html">Set up an AWS transit gateway</a></li>
  

  
    <li><a href="reference_networking_azure.html">Cloud Volumes ONTAP for Azure</a></li>
  

  
    <li><a href="reference_networking_gcp.html">Cloud Volumes ONTAP for GCP</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Additional deployment options</a>
      <ul>
        

  
    <li><a href="reference_cloud_mgr_reqs.html">Cloud Manager host requirements</a></li>
  

  
    <li><a href="task_installing_linux.html">Install Cloud Manager on Linux</a></li>
  

  
    <li><a href="task_launching_aws_mktp.html">Deploy Cloud Manager from the AWS Marketplace</a></li>
  

  
    <li><a href="task_launching_azure_mktp.html">Deploy Cloud Manager from the Azure Marketplace</a></li>
  

  
    <li><a href="task_installing_azure_gov.html">Deploy Cloud Manager in an Azure Gov region</a></li>
  

  
    <li><a href="task_installing_azure_germany.html">Deploy Cloud Manager in the Azure Germany region</a></li>
  

  
    <li><a href="https://docs.netapp.com/us-en/occm/media/c2s.pdf" target="_blank">Get started in AWS C2S</a></li>
  


      </ul>
    </li>
  

  
    <li><a href="concept_keep_up.html">Keep Cloud Manager running</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Deploy Cloud Volumes ONTAP</a>
      <ul>
        

  
    <li><a href="reference_before.html">Before you begin</a></li>
  

  
    <li><a href="task_logging_in.html">Log in to Cloud Manager</a></li>
  

  
    <li><a href="task_planning_your_config.html">Plan your configuration</a></li>
  

  
    <li><a href="task_finding_system_id.html">Find your system ID</a></li>
  

  
    <li><a href="task_enabling_flash_cache.html">Enable Flash Cache</a></li>
  

  
    <li><a href="task_deploying_otc_aws.html">Launch Cloud Volumes ONTAP in AWS</a></li>
  

  
    <li><a href="task_deploying_otc_azure.html">Launch Cloud Volumes ONTAP in Azure</a></li>
  

  
    <li><a href="task_deploying_gcp.html">Launch Cloud Volumes ONTAP in GCP</a></li>
  

  
    <li><a href="task_registering.html">Register pay-as-you-go systems</a></li>
  

  
    <li><a href="task_setting_up_ontap_cloud.html">Set up Cloud Volumes ONTAP</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Provision storage</a>
      <ul>
        

  
    <li><a href="task_provisioning_storage.html">Create volumes, aggregates, and LUNs</a></li>
  

  
    <li><a href="task_tiering.html">Tier inactive data to object storage</a></li>
  

  
    <li><a href="task_connecting_kubernetes.html">Use ONTAP as persistent storage</a></li>
  

  
    <li><a href="task_encrypting_volumes.html">Encrypt volumes with NetApp Volume Encryption</a></li>
  

  
    <li><a href="task_managing_storage.html">Manage existing storage</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Replicate and protect data</a>
      <ul>
        

  
    <li><a href="task_discovering_ontap.html">Discover and manage ONTAP clusters</a></li>
  

  
    <li><a href="task_replicating_data.html">Replicate data between systems</a></li>
  

  
    <li><a href="task_backup_to_s3.html">Back up to Amazon S3</a></li>
  

  
    <li><a href="task_syncing_s3.html">Sync data to Amazon S3</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Gain insight into data privacy</a>
      <ul>
        

  
    <li><a href="concept_cloud_compliance.html">Learn about Cloud Compliance</a></li>
  

  
    <li><a href="task_getting_started_compliance.html">Get started</a></li>
  

  
    <li><a href="task_controlling_private_data.html">Gain visibility and control of data</a></li>
  

  
    <li><a href="task_generating_compliance_reports.html">Generate reports</a></li>
  

  
    <li><a href="task_responding_to_dsar.html">Respond to a DSAR</a></li>
  

  
    <li><a href="task_managing_compliance.html">Disable Cloud Compliance</a></li>
  

  
    <li><a href="faq_cloud_compliance.html">FAQ</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Administer Cloud Volumes ONTAP</a>
      <ul>
        

  
    <li><a href="task_connecting_to_otc.html">Connect to Cloud Volumes ONTAP</a></li>
  

  
    <li><a href="task_updating_ontap_cloud.html">Update software</a></li>
  

  
    <li><a href="task_modifying_ontap_cloud.html">Modify system configurations</a></li>
  

  
    <li><a href="task_managing_state.html">Stop and start systems</a></li>
  

  
    <li><a href="task_monitoring_costs.html">Monitor AWS costs</a></li>
  

  
    <li><a href="task_protecting_ransomware.html">Improve ransomware protection</a></li>
  

  
    <li><a href="task_adding_ontap_cloud.html">Add existing systems</a></li>
  

  
    <li><a href="task_deleting_working_env.html">Delete systems</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Administer Cloud Manager</a>
      <ul>
        

  
    <li><a href="task_updating_cloud_manager.html">Update Cloud Manager</a></li>
  

  
    <li><a href="task_managing_cloud_central_accounts.html">Manage the Cloud Central account</a></li>
  

  
    <li><a href="task_removing.html">Remove working environments</a></li>
  

  
    <li><a href="task_configuring_proxy.html">Configure proxy settings</a></li>
  

  
    <li><a href="task_renewing_cert.html">Renew the HTTPS certificate</a></li>
  

  
    <li><a href="task_overriding_cifs_locks.html">Override CIFS locks in Azure</a></li>
  

  
    <li><a href="task_restoring.html">Restore Cloud Manager</a></li>
  

  
    <li><a href="task_uninstalling.html">Uninstall Cloud Manager</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Provision volumes for file services</a>
      <ul>
        

  
    <li><a href="task_manage_anf.html">Azure NetApp Files</a></li>
  

  
    <li><a href="task_manage_cvs_aws.html">Cloud Volumes Service for AWS</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">APIs and automation</a>
      <ul>
        

  
    <li><a href="https://docs.netapp.com/us-en/occm/api.html" target="_blank">API Developer Guide</a></li>
  

  
    <li><a href="reference_infrastructure_as_code.html">Automation samples</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Reference</a>
      <ul>
        

  
    <li><a href="reference_integration_faq.html">FAQ for Cloud Central integration</a></li>
  

  
    <li><a href="https://docs.netapp.com/us-en/cloud-volumes-ontap/index.html" target="_blank">Supported configurations for Cloud Volumes ONTAP</a></li>
  

  
    <li><a href="https://cloud.netapp.com/cloud-volumes-global-regions" target="_blank">Supported regions</a></li>
  

  
    <li><a href="reference_security_groups.html">Security group rules for AWS</a></li>
  

  
    <li><a href="reference_security_groups_azure.html">Security group rules for Azure</a></li>
  

  
    <li><a href="reference_firewall_rules_gcp.html">Firewall rules for GCP</a></li>
  

  
    <li><a href="reference_aws_marketplace.html">AWS Marketplace pages</a></li>
  

  
    <li><a href="reference_permissions.html">Permissions</a></li>
  

  
    <li><a href="reference_default_configs.html">Default configurations</a></li>
  

  
    <li><a href="reference_user_roles.html">User roles</a></li>
  

  
    <li><a href="reference_additional_info.html">Related links</a></li>
  


      </ul>
    </li>
  

  
    <li><a href="reference_earlier_versions.html">Earlier versions</a></li>
  

  
    <li><a href="reference_legal_notices.html">Legal notices</a></li>
  


</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

      </div>
      

      <div class="n-doc__component-detail-content n-doc__component-detail-content--show-code">
        <!-- Begin of page container -->
        <article class="page-content">
          



<div class="n-doc__component-detail-heading-wrap">
  <h1 class="n-doc__component-detail-heading">Setting up and adding Azure accounts to Cloud Manager
    <span>
      
        <a target="_blank" href="https://github.com/NetAppDocs/occm/blob/master/task_adding_azure_accounts.adoc" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit on GitHub</a>
        <a target="_blank" href="https://github.com/NetAppDocs/occm/issues/new?body=Page%3A%20[Setting up and adding Azure accounts to Cloud Manager](https://docs.netapp.com/en/occm/task_adding_azure_accounts.html)" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Request doc changes</a>
      
    </span>
  </h1>
</div>

<p class="page-details">

<time datetime="2020-02-03 13:30:11 +0000">02/03/2020</time>


<span>Contributors
  
  <a target="_blank" href="https://github.com/netapp-bcammett">
    <img  class="avatar avatar-small"
          alt="netapp-bcammett"
          width="20" height="20"
          src="https://avatars3.githubusercontent.com/u/18287750?v=4"
          style="border-radius: 50%;"/>
  </a>
  
</span>

</p>

<div id="preamble">
<div class="sectionbody">
<div class="paragraph lead">
<p>If you want to deploy Cloud Volumes ONTAP in different Azure accounts, then you need to provide the required permissions to those accounts and then add the account credentials to Cloud Manager.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When you deploy Cloud Manager from Cloud Central, Cloud Manager automatically adds the Azure account in which you deployed Cloud Manager. An initial account is not added if you manually installed the Cloud Manager software on an existing system. <a href="concept_accounts_azure.html">Learn about Azure accounts and permissions</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="granting-azure-permissions-using-a-service-principal">Granting Azure permissions using a service principal</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Cloud Manager needs permissions to perform actions in Azure. You can grant the required permissions to an Azure account by creating and setting up a service principal in Azure Active Directory and by obtaining the Azure credentials that Cloud Manager needs.</p>
</div>
<div class="paragraph">
<div class="title">About this task</div>
<p>The following image depicts how Cloud Manager obtains permissions to perform operations in Azure. A service principal object, which is tied to one or more Azure subscriptions, represents Cloud Manager in Azure Active Directory and is assigned to a custom role that allows the required permissions.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="./media/diagram_azure_authentication.png" alt="Conceptual image that shows Cloud Manager obtaining authentication and authorization from Azure Active Directory before it can make an API call. In Active Directory" width="the Cloud Manager Operator role defines permissions. It is tied to one or more Azure subscriptions and a service principal object that represents the Cloud Manger application."></span></p>
</div>
<div class="olist arabic">
<div class="title">Steps</div>
<ol class="arabic">
<li>
<p><a href="#creating-an-azure-active-directory-application">Create an Azure Active Directory application</a>.</p>
</li>
<li>
<p><a href="#assigning-the-application-to-a-role">Assign the application to a role</a>.</p>
</li>
<li>
<p><a href="#adding-windows-azure-service-management-api-permissions">Add Windows Azure Service Management API permissions</a>.</p>
</li>
<li>
<p><a href="#ids">Get the application ID and directory ID</a>.</p>
</li>
<li>
<p><a href="#creating-a-client-secret">Create a client secret</a>.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="creating-an-azure-active-directory-application">Creating an Azure Active Directory application</h3>
<div class="paragraph">
<p>Create an Azure Active Directory (AD) application and service principal that Cloud Manager can use for role-based access control.</p>
</div>
<div class="paragraph">
<div class="title">Before you begin</div>
<p>You must have the right permissions in Azure to create an Active Directory application and to assign the application to a role. For details, refer to <a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal#required-permissions/" target="_blank" rel="noopener">Microsoft Azure Documentation: Required permissions</a>.</p>
</div>
<div class="olist arabic">
<div class="title">Steps</div>
<ol class="arabic">
<li>
<p>From the Azure portal, open the <strong>Azure Active Directory</strong> service.</p>
<div class="paragraph">
<p><span class="image"><img src="./media/screenshot_azure_ad.gif" alt="Shows the Active Directory service in Microsoft Azure."></span></p>
</div>
</li>
<li>
<p>In the menu, click <strong>App registrations</strong>.</p>
</li>
<li>
<p>Click <strong>New registration</strong>.</p>
</li>
<li>
<p>Specify details about the application:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: Enter a name for the application.</p>
</li>
<li>
<p><strong>Account type</strong>: Select an account type (any will work with Cloud Manager).</p>
</li>
<li>
<p><strong>Redirect URI</strong>: Select <strong>Web</strong> and then enter any URL—for example, https://url</p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>Register</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Result</div>
<p>You&#8217;ve created the AD application and service principal.</p>
</div>
</div>
<div class="sect2">
<h3 id="assigning-the-application-to-a-role">Assigning the application to a role</h3>
<div class="paragraph">
<p>You must bind the service principal to one or more Azure subscriptions and assign it the custom "OnCommand Cloud Manager Operator" role so Cloud Manager has permissions in Azure.</p>
</div>
<div class="olist arabic">
<div class="title">Steps</div>
<ol class="arabic">
<li>
<p>Create a custom role:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Download the <a href="https://mysupport.netapp.com/cloudontap/iampolicies" target="_blank" rel="noopener">Cloud Manager Azure policy</a>.</p>
</li>
<li>
<p>Modify the JSON file by adding Azure subscription IDs to the assignable scope.</p>
<div class="paragraph">
<p>You should add the ID for each Azure subscription from which users will create Cloud Volumes ONTAP systems.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"AssignableScopes": [
"/subscriptions/d333af45-0d07-4154-943d-c25fbzzzzzzz",
"/subscriptions/54b91999-b3e6-4599-908e-416e0zzzzzzz",
"/subscriptions/398e471c-3b42-4ae7-9b59-ce5bbzzzzzzz"</code></pre>
</div>
</div>
</li>
<li>
<p>Use the JSON file to create a custom role in Azure.</p>
<div class="paragraph">
<p>The following example shows how to create a custom role using the Azure CLI 2.0:</p>
</div>
<div class="paragraph">
<p><strong>az role definition create --role-definition C:\Policy_for_cloud_Manager_Azure_3.7.4.json</strong></p>
</div>
<div class="paragraph">
<p>You should now have a custom role called <em>OnCommand Cloud Manager Operator</em>.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Assign the application to the role:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>From the Azure portal, open the <strong>Subscriptions</strong> service.</p>
</li>
<li>
<p>Select the subscription.</p>
</li>
<li>
<p>Click <strong>Access control (IAM) &gt; Add &gt; Add role assignment</strong>.</p>
</li>
<li>
<p>Select the <strong>OnCommand Cloud Manager Operator</strong> role.</p>
</li>
<li>
<p>Keep <strong>Azure AD user, group, or service principal</strong> selected.</p>
</li>
<li>
<p>Search for the name of the application (you can&#8217;t find it in the list by scrolling).</p>
<div class="paragraph">
<p><span class="image"><img src="./media/screenshot_azure_service_principal_role.gif" alt="A screenshot that shows the Add role assignment form in the Azure portal."></span></p>
</div>
</li>
<li>
<p>Select the application and click <strong>Save</strong>.</p>
<div class="paragraph">
<p>The service principal for Cloud Manager now has the required Azure permissions for that subscription.</p>
</div>
<div class="paragraph">
<p>If you want to deploy Cloud Volumes ONTAP from multiple Azure subscriptions, then you must bind the service principal to each of those subscriptions. Cloud Manager enables you to select the subscription that you want to use when deploying Cloud Volumes ONTAP.</p>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="adding-windows-azure-service-management-api-permissions">Adding Windows Azure Service Management API permissions</h3>
<div class="paragraph">
<p>The service principal must have "Windows Azure Service Management API" permissions.</p>
</div>
<div class="olist arabic">
<div class="title">Steps</div>
<ol class="arabic">
<li>
<p>In the <strong>Azure Active Directory</strong> service, click <strong>App registrations</strong> and select the application.</p>
</li>
<li>
<p>Click <strong>API permissions &gt; Add a permission</strong>.</p>
</li>
<li>
<p>Under <strong>Microsoft APIs</strong>, select <strong>Azure Service Management</strong>.</p>
<div class="paragraph">
<p><span class="image"><img src="./media/screenshot_azure_service_mgmt_apis.gif" alt="A screenshot of the Azure portal that shows the Azure Service Management API permissions."></span></p>
</div>
</li>
<li>
<p>Click <strong>Access Azure Service Management as organization users</strong> and then click <strong>Add permissions</strong>.</p>
<div class="paragraph">
<p><span class="image"><img src="./media/screenshot_azure_service_mgmt_apis_add.gif" alt="A screenshot of the Azure portal that shows adding the Azure Service Management APIs."></span></p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="ids">Getting the application ID and directory ID</h3>
<div class="paragraph">
<p>When you add the Azure account to Cloud Manager, you need to provide the application (client) ID and the directory (tenant) ID for the application. Cloud Manager uses the IDs to programmatically sign in.</p>
</div>
<div class="olist arabic">
<div class="title">Steps</div>
<ol class="arabic">
<li>
<p>In the <strong>Azure Active Directory</strong> service, click <strong>App registrations</strong> and select the application.</p>
</li>
<li>
<p>Copy the <strong>Application (client) ID</strong> and the <strong>Directory (tenant) ID</strong>.</p>
<div class="paragraph">
<p><span class="image"><img src="./media/screenshot_azure_app_ids.gif" alt="A screenshot that shows the application (client) ID and directory (tenant) ID for an application in Azure Active Directory."></span></p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="creating-a-client-secret">Creating a client secret</h3>
<div class="paragraph">
<p>You need to create a client secret and then provide Cloud Manager with the value of the secret so Cloud Manager can use it to authenticate with Azure AD.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When you add the account to Cloud Manager, Cloud Manager refers to the client secret as the Application Key.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Steps</div>
<ol class="arabic">
<li>
<p>Open the <strong>Azure Active Directory</strong> service.</p>
</li>
<li>
<p>Click <strong>App registrations</strong> and select your application.</p>
</li>
<li>
<p>Click <strong>Certificates &amp; secrets &gt; New client secret</strong>.</p>
</li>
<li>
<p>Provide a description of the secret and a duration.</p>
</li>
<li>
<p>Click <strong>Add</strong>.</p>
</li>
<li>
<p>Copy the value of the client secret.</p>
<div class="paragraph">
<p><span class="image"><img src="./media/screenshot_azure_client_secret.gif" alt="A screenshot of the Azure portal that shows a client secret for the Azure AD service principal."></span></p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Result</div>
<p>Your service principal is now setup and you should have copied the application (client) ID, the directory (tenant) ID, and the value of the client secret. You need to enter this information in Cloud Manager when you add an Azure account.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="adding-azure-credentials-to-cloud-manager">Adding Azure credentials to Cloud Manager</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After you provide an Azure account with the required permissions, you can add the credentials for that account to Cloud Manager. This enables you to launch Cloud Volumes ONTAP systems in that account.</p>
</div>
<div class="olist arabic">
<div class="title">Steps</div>
<ol class="arabic">
<li>
<p>In the upper right of the Cloud Manager console, click the Settings icon, and select <strong>Credentials</strong>.</p>
<div class="paragraph">
<p><span class="image"><img src="./media/screenshot_settings_icon.gif" alt="A screenshot that shows the Settings icon in the upper right of the Cloud Manager console."></span></p>
</div>
</li>
<li>
<p>Click <strong>Add Credentials</strong> and select <strong>Microsoft Azure</strong>.</p>
</li>
<li>
<p>Enter information about the Azure Active Directory service principal that grants the required permissions:</p>
<div class="ulist">
<ul>
<li>
<p>Application (client) ID: See <a href="#ids">Getting the application ID and directory ID</a>.</p>
</li>
<li>
<p>Directory (tenant) ID: See <a href="#ids">Getting the application ID and directory ID</a>.</p>
</li>
<li>
<p>Client Secret: See <a href="#creating-a-client-secret">Creating a client secret</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Confirm that the policy requirements have been met and then click <strong>Create Account</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Result</div>
<p>You can now switch to different set of credentials from the Details and Credentials page when creating a new working environment:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="./media/screenshot_accounts_switch_azure.gif" alt="A screenshot that shows selecting between cloud provider accounts after clicking Switch Account in the Details &amp; Credentials page."></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="associating-additional-azure-subscriptions-with-a-managed-identity">Associating additional Azure subscriptions with a managed identity</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Cloud Manager enables you to choose the Azure account and subscription in which you want to deploy Cloud Volumes ONTAP. You can&#8217;t select a different Azure subscription for the managed identity profile unless you associate the <a href="https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview" target="_blank" rel="noopener">managed identity</a> with those subscriptions.</p>
</div>
<div class="paragraph">
<div class="title">About this task</div>
<p>A managed identity is <a href="concept_accounts_azure.html">the initial Azure account</a> when you deploy Cloud Manager from NetApp Cloud Central. When you deployed Cloud Manager, Cloud Central created the OnCommand Cloud Manager Operator role and assigned it to the Cloud Manager virtual machine.</p>
</div>
<div class="olist arabic">
<div class="title">Steps</div>
<ol class="arabic">
<li>
<p>Log in to the Azure portal.</p>
</li>
<li>
<p>Open the <strong>Subscriptions</strong> service and then select the subscription in which you want to deploy Cloud Volumes ONTAP systems.</p>
</li>
<li>
<p>Click <strong>Access control (IAM)</strong>.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click <strong>Add</strong> &gt; <strong>Add role assignment</strong> and then add the permissions:</p>
<div class="ulist">
<ul>
<li>
<p>Select the <strong>OnCommand Cloud Manager Operator</strong> role.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
OnCommand Cloud Manager Operator is the default name provided in the <a href="https://mysupport.netapp.com/info/web/ECMP11022837.html">Cloud Manager policy</a>. If you chose a different name for the role, then select that name instead.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Assign access to a <strong>Virtual Machine</strong>.</p>
</li>
<li>
<p>Select the subscription in which the Cloud Manager virtual machine was created.</p>
</li>
<li>
<p>Select the Cloud Manager virtual machine.</p>
</li>
<li>
<p>Click <strong>Save</strong>.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Repeat these steps for additional subscriptions.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Result</div>
<p>When you create a new working environment, you should now have the ability to select from multiple Azure subscriptions for the managed identity profile.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="./media/screenshot_accounts_switch_azure_subscription.gif" alt="A screenshot that shows the ability to select multiple Azure subscriptions when selecting a Microsoft Azure Provider Account."></span></p>
</div>
</div>
</div>



        </article>
        <!-- Page Container -->
      </div>

      
      <div class="page-nav-container">
        <nav class="page-nav-fixed">
          <div class="page-nav-title">On this page:</div>
          <ul class="page-nav-inner" id="page-menu"></ul>
        </nav>
      </div>
      

    </div>
  </div>
</div>


      </main>

      <!-- Footer -->
      
      <footer class="n-footer n-footer--v1" style="border-top: solid 10px #DFDFDF;">
        <div class="n-footer__bottom">
          <div class="n-container">
            <div class="n-footer__bottom-left">
              <div class="n-footer__copyright">
                  <a href="//www.netapp.com/us/legal/copyright.aspx" class="n-footer__copyright-link">© 2020 NetApp, Inc.</a>
              </div>
              <div class="n-footer__copyright">
                <a href="//www.netapp.com/us/legal/index.aspx" class="n-footer__copyright-link">Legal</a>
              </div>
              <div class="n-footer__social-links n-footer__copyright">
                <ul class="n-footer__social-link-list">
                  <li class="n-footer__social-link-list-item">
                    <a class="n-footer__social-link" data-ntap-social="follow-blog" href="http://blog.netapp.com" target="_blank" title="blog" alt="blog">
                      <span class="n-footer__social-link-text">blog</span>
                      <svg class="n-icon-blog n-footer__social-link-icon" aria-labelledby="title">
                        <title>blog@</title>
                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/occm/en/common/svg/sprite.svg#blog"></use>
                      </svg>
                    </a>
                  </li>
                  <li class="n-footer__social-link-list-item">
                    <a class="n-footer__social-link" data-ntap-social="follow-community" href="http://community.netapp.com/" target="_blank" title="community" alt="community">
                      <span class="n-footer__social-link-text">community</span>
                      <svg class="n-icon-twitter n-footer__social-link-icon" aria-labelledby="title">
                        <title>community@</title>
                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/occm/en/common/svg/sprite.svg#comments"></use>
                      </svg>
                    </a>
                  </li>

                  <li class="n-footer__social-link-list-item">
                    <a class="n-footer__social-link" data-ntap-social="follow-twitter" href="https://twitter.com/netappdoc" target="_blank" title="twitter" alt="twitter">
                      <span class="n-footer__social-link-text">twitter</span>
                      <svg class="n-icon-twitter n-footer__social-link-icon" aria-labelledby="title">
                        <title>twitter@</title>
                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/occm/en/common/svg/sprite.svg#twitter"></use>
                      </svg>
                    </a>
                  </li>
                  <li class="n-footer__social-link-list-item">
                    <a class="n-footer__social-link" data-ntap-social="follow-youtube" href="https://www.youtube.com/user/NetAppTechCommTV/" target="_blank" title="youtube" alt="youtube">
                      <span class="n-footer__social-link-text">youtube</span>
                      <svg class="n-icon-youtube n-footer__social-link-icon" aria-labelledby="title">
                        <title>youtube@</title>
                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/occm/en/common/svg/sprite.svg#youtube"></use>
                      </svg>
                    </a>
                  </li>
                </ul>
              </div>
            </div>
            <div class="n-footer__bottom-right">
              <div class="n-footer__copyright">
                <a href="https://docs.netapp.com/en/contribute/" class="n-footer__copyright-link">Contribute</a>
              </div>
              <div class="n-footer__copyright">
                <a target="_self" class="n-footer__copyright-link" href="javascript:netapp_mailto()">Email your feedback</a>
              </div>
              <div class="n-footer__copyright">
                <a href="https://docs.netapp.com/en/announcements/" class="n-footer__copyright-link">Announcements</a>
              </div>
            </div>
          </div>
        </div>
      </footer>

    </div>

    <script src="/occm/en/common/js/components.js"></script>
    <script src="/occm/en/common/js/doc-components.js"></script>

    <!-- Elasticsearch JS -->
    <script type="text/javascript" src='/occm/en/js/bundle.js'></script>

    <!-- Syntax Highlighting -->
    <script type="text/javascript" src='/occm/en/js/prism.js'></script>
    <script type="text/javascript" src='/occm/en/js/prism-curl.js'></script>

  </body>

  
</html>


